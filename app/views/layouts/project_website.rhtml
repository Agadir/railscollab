<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html>
  <head>
  	<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <% if not @active_project.nil? %>
    <title><%= h @active_project.name %> - <%= h @page_title %> @ <%= h Company.owner.name %></title>
    <% else %>
    <title><%= h @page_title %> @ <%= h Company.owner.name %></title>
    <% end %>
    
	<%= stylesheet_link_tag 'project_website' %>
	<% if not @additional_stylesheets.nil?
	  @additional_stylesheets.each do |ss| -%>
	  <%= stylesheet_link_tag ss %>
	  <% end %>
	<% end %>
	<%= javascript_include_tag 'prototype.js' %>
	<%= javascript_include_tag 'effects.js' %>
	<%= javascript_include_tag 'dragdrop.js' %>
	<%= javascript_include_tag 'controls.js' %>
	<%= javascript_include_tag 'lowpro.js' %>
	<%= javascript_include_tag 'application.js' %>
<!-- head needs to go here? -->
  </head>
  <body id="body">
<%= render :partial => 'layouts/system_notices', :collection => system_notices %>
    <div id="wrapper">
      
      <!-- header -->
      <div id="headerWrapper">
        <div id="header">
          <h1><%= link_to (h @active_project.name), :controller => 'project', :action => 'overview', :id => @active_project.id %></h1>
          <div id="userboxWrapper"><%= render :partial => 'layouts/user_box', :locals => {:user => @logged_user, :projects => @active_projects} %></div>
        </div>
      </div>
      <!-- /header -->

      <%= render :partial => 'layouts/tabs' if not @tabbed_navigation_items.nil? %>
            
      <div id="crumbsWrapper">
        <div id="crumbsBlock">
          <%= render :partial => 'layouts/crumbs' if not @bread_crumbs.nil? %> 
          
          <% if AppConfig.search_enabled %>
          <div id="searchBox">
            <%= form_tag :controller => 'project', :action => 'search' %>
              <div>
<%
  @search_field_default_value = "Search..."
  #@last_search ||= @search_field_default_value
  @search_field_attrs = {
	 # :onfocus => "if (event.target.value == '#{@search_field_default_value}' event.target.value=''",
	#	:onblur => "if (event.target.value == '#{@search_field_default_value}' event.target.value=''"
  }
%>
                <%= text_field_tag 'search_id', (h @last_search), @search_field_attrs %><button type="submit"><%= "Go" %></button>
              </div>
            </form>
          </div>
         <% end %>
           
        </div>
      </div>
      
      <!-- content wrapper -->
      <div id="outerContentWrapper">
        <div id="innerContentWrapper">
<% if flash[:message] %>
          <div id="status_bar" class="<%= flash[:error] ? 'flash_error' : 'flash_success' %>"><%= h flash[:message] %></div>
<% end %>
          <h1 id="pageTitle"><%= h @page_title %></h1>
          <div id="pageContent">
            <div id="content">
              <%= render :partial => 'layouts/actions' if not @page_actions.nil? %>
              <!-- Content -->
              <%= yield %>
              <!-- /Content -->
            </div>
<% if not @content_for_sidebar.nil? %>
            <div id="sidebar"><%= render :partial => @content_for_sidebar, :locals => {:users => @online_users, :logged_user => @logged_user, :my_projects => @my_projects, :active_projects => @active_projects, :finished_projects => @finished_projects} %></div>
<% end %>
            <div class="clear"></div>
          </div>
        </div>
        
        <!--Footer -->
        <%= render :partial => 'layouts/footer' %>
      </div>
      <!-- /content wrapper -->
      
    </div>
  </body>
</html>
